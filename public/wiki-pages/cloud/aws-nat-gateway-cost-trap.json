{
  "title": "$100K AWS ë¼ìš°íŒ… ë¹„ìš© í•¨ì •: S3 + NAT ê²Œì´íŠ¸ì›¨ì´ì™€ Terraform í•´ê²°ë²•",
  "slug": "cloud/aws-nat-gateway-cost-trap",
  "content": "\n# $100K AWS ë¼ìš°íŒ… ë¹„ìš© í•¨ì •: S3 + NAT ê²Œì´íŠ¸ì›¨ì´\n\n> \"ê¸°ë³¸ì ìœ¼ë¡œ ë³´ì•ˆ\" AWS ì•„í‚¤í…ì²˜ê°€ ì˜ë„ì¹˜ ì•Šê²Œ ë¹„ìš©ì„ í­ë°œì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í´ë¼ìš°ë“œ ë¹„ìš© ê¸‰ì¦ì˜ ì£¼ìš” ì›ì¸ì€ ê³¼ë‹¤ í”„ë¡œë¹„ì €ë‹ëœ EC2ê°€ ì•„ë‹ˆë¼ **ì˜ë„í•˜ì§€ ì•Šì€ ë°ì´í„° ì „ì†¡ ê²½ë¡œ**ì…ë‹ˆë‹¤.\n\n---\n\n## ë¬¸ì œ: NAT ê²Œì´íŠ¸ì›¨ì´ì˜ ìˆ¨ì€ ë¹„ìš©\n\n### ì¼ë°˜ì ì¸ \"ë³´ì•ˆ\" ì•„í‚¤í…ì²˜\n```\nPrivate Subnet (EC2)\n    â†“ S3 ìš”ì²­\nNAT Gateway\n    â†“ í¼ë¸”ë¦­ S3 ì—”ë“œí¬ì¸íŠ¸ë¡œ ì „ì†¡\nInternet Gateway\n    â†“ AWS ë°±ë³¸ì„ ë²—ì–´ë‚¨\nS3 (í¼ë¸”ë¦­ ì„œë¹„ìŠ¤)\n```\n\n### ì™œ ë¹„ìš©ì´ ë‘ ë°°ê°€ ë˜ëŠ”ê°€\n\n1. ì»´í“¨íŠ¸ ì¸ìŠ¤í„´ìŠ¤ëŠ” í¼ë¸”ë¦­ IP ì—†ì´ **í”„ë¼ì´ë¹— ì„œë¸Œë„·**ì— ë°°ì¹˜ë©ë‹ˆë‹¤\n2. ì•„ì›ƒë°”ìš´ë“œ íŠ¸ë˜í”½ì€ **ê´€ë¦¬í˜• NAT ê²Œì´íŠ¸ì›¨ì´**ë¥¼ í†µí•´ ë¼ìš°íŒ…ë©ë‹ˆë‹¤\n3. S3ëŠ” í¼ë¸”ë¦­ ì„œë¹„ìŠ¤ ì—”ë“œí¬ì¸íŠ¸ì´ë¯€ë¡œ, ë°ì´í„°ê°€ AWS ë°±ë³¸ì„ ë²—ì–´ë‚˜ **ë‘ ë²ˆ** ì¸¡ì •ë©ë‹ˆë‹¤\n\ní•˜ë£¨ì— 10 TBë¥¼ ë‹¤ìš´ë¡œë“œí•˜ëŠ” íŒŒì´í”„ë¼ì¸ì´ë¼ë©´ ì‹¤ì œë¡œëŠ” **20 TBì˜ ì•„ì›ƒë°”ìš´ë“œ**ì— ëŒ€í•´ ì²­êµ¬ë©ë‹ˆë‹¤.\n\n### ì²­êµ¬ë˜ëŠ” ë¹„ìš© í•­ëª©\n\n| í•­ëª© | ìš”ê¸ˆ |\n|------|------|\n| NAT ê²Œì´íŠ¸ì›¨ì´ ì‹œê°„ë‹¹ ê°€ë™ ë¹„ìš© | ~$0.045/hr |\n| NAT ê²Œì´íŠ¸ì›¨ì´ ì²˜ë¦¬ ìˆ˜ìˆ˜ë£Œ | $0.045/GB |\n| í‘œì¤€ ì¸í„°ë„· ì•„ì›ƒë°”ìš´ë“œ ìš”ê¸ˆ | ~$0.09/GB (ì²« 10TB) |\n\n> **ì˜ˆì‹œ**: ì›” 300 TB S3 ë‹¤ìš´ë¡œë“œ ì‹œ NAT ì²˜ë¦¬ ìˆ˜ìˆ˜ë£Œë§Œ **$13,500/ì›”** ($162,000/ë…„)\n\n---\n\n## í•´ê²°ì±…: S3ìš© VPC ê²Œì´íŠ¸ì›¨ì´ ì—”ë“œí¬ì¸íŠ¸\n\nVPC ê²Œì´íŠ¸ì›¨ì´ ì—”ë“œí¬ì¸íŠ¸ë¥¼ ìƒì„±í•˜ë©´ S3 íŠ¸ë˜í”½ì´ **AWS ë°±ë³¸ ë‚´ë¶€**ì— ë¨¸ë¬´ë¥´ê²Œ ë©ë‹ˆë‹¤. NAT ê²Œì´íŠ¸ì›¨ì´ë¥¼ ìš°íšŒí•˜ê³ , ë‚´ë¶€ ì „ì†¡ ë¹„ìš©ì´ **$0.00**ìœ¼ë¡œ ê°ì†Œí•©ë‹ˆë‹¤.\n\n### ë³€ê²½ í›„ ì•„í‚¤í…ì²˜\n```\nPrivate Subnet (EC2)\n    â†“ S3 ìš”ì²­\nVPC Gateway Endpoint\n    â†“ AWS ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬\nS3 (ì§ì ‘ ì ‘ê·¼)\n```\n\n### Terraform êµ¬í˜„\n\n```hcl\n# VPC ê²Œì´íŠ¸ì›¨ì´ ì—”ë“œí¬ì¸íŠ¸ ìƒì„±\nresource \"aws_vpc_endpoint\" \"s3\" {\n  vpc_id            = aws_vpc.main.id\n  service_name      = \"com.amazonaws.${var.region}.s3\"\n  vpc_endpoint_type = \"Gateway\"\n}\n\n# í”„ë¼ì´ë¹— ì„œë¸Œë„· ë¼ìš°íŠ¸ í…Œì´ë¸”ì— ì—°ê²°\nresource \"aws_vpc_endpoint_route_table_association\" \"s3\" {\n  route_table_id  = aws_route_table.private.id\n  vpc_endpoint_id = aws_vpc_endpoint.s3.id\n}\n```\n\n### ì ìš© í™•ì¸\n```bash\n# ì—”ë“œí¬ì¸íŠ¸ ìƒíƒœ í™•ì¸\naws ec2 describe-vpc-endpoints \\\n  --filters \"Name=service-name,Values=com.amazonaws.ap-northeast-2.s3\" \\\n  --query \"VpcEndpoints[].State\"\n\n# S3 íŠ¸ë˜í”½ì´ NATë¥¼ ìš°íšŒí•˜ëŠ”ì§€ í™•ì¸\naws ec2 describe-route-tables \\\n  --route-table-ids rtb-xxxxx \\\n  --query \"RouteTables[].Routes[?DestinationPrefixListId]\"\n```\n\n---\n\n## ì¶”ê°€ ë¹„ìš© ì ˆê° í¬ì¸íŠ¸\n\n### 1. DynamoDB ê²Œì´íŠ¸ì›¨ì´ ì—”ë“œí¬ì¸íŠ¸\nS3ì™€ ë™ì¼í•˜ê²Œ DynamoDBë„ ê²Œì´íŠ¸ì›¨ì´ ì—”ë“œí¬ì¸íŠ¸ë¥¼ ì§€ì›í•©ë‹ˆë‹¤.\n\n```hcl\nresource \"aws_vpc_endpoint\" \"dynamodb\" {\n  vpc_id            = aws_vpc.main.id\n  service_name      = \"com.amazonaws.${var.region}.dynamodb\"\n  vpc_endpoint_type = \"Gateway\"\n}\n```\n\n### 2. ì¸í„°í˜ì´ìŠ¤ ì—”ë“œí¬ì¸íŠ¸ (PrivateLink)\nECR, CloudWatch, SSM ë“± ë‹¤ë¥¸ AWS ì„œë¹„ìŠ¤ëŠ” **ì¸í„°í˜ì´ìŠ¤ ì—”ë“œí¬ì¸íŠ¸**ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ì‹œê°„ë‹¹ ë¹„ìš©($0.01/hr)ì´ ìˆì§€ë§Œ, NAT ì²˜ë¦¬ ìˆ˜ìˆ˜ë£Œë³´ë‹¤ ì €ë ´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n### 3. NAT ê²Œì´íŠ¸ì›¨ì´ ëª¨ë‹ˆí„°ë§\n```bash\n# NAT ê²Œì´íŠ¸ì›¨ì´ë¥¼ í†µí•œ ë°”ì´íŠ¸ ìˆ˜ í™•ì¸ (CloudWatch)\naws cloudwatch get-metric-statistics \\\n  --namespace AWS/NATGateway \\\n  --metric-name BytesOutToDestination \\\n  --dimensions Name=NatGatewayId,Value=nat-xxxxx \\\n  --start-time 2026-02-01T00:00:00Z \\\n  --end-time 2026-02-22T00:00:00Z \\\n  --period 86400 \\\n  --statistics Sum\n```\n\n---\n\n## í•µì‹¬ ì›ì¹™\n\n> **ë°ì´í„° ì¤‘ë ¥**ì´ ê¸°ë³¸ ë¹„ìš©ì„ ê²°ì •í•˜ê³ , **ë¼ìš°íŒ…**ì´ ê·¸ ë¹„ìš©ì— ê³±í•´ì§€ëŠ” ë°°ìˆ˜ë¥¼ ê²°ì •í•©ë‹ˆë‹¤.\n\n1. **VPC ì—”ë“œí¬ì¸íŠ¸ë¥¼ ê¸°ë³¸ìœ¼ë¡œ** â€“ S3, DynamoDBëŠ” ê²Œì´íŠ¸ì›¨ì´ ì—”ë“œí¬ì¸íŠ¸ë¥¼ í•­ìƒ ìƒì„±\n2. **NAT íŠ¸ë˜í”½ì„ ëª¨ë‹ˆí„°ë§** â€“ CloudWatch ë©”íŠ¸ë¦­ìœ¼ë¡œ ì˜ˆìƒì¹˜ ëª»í•œ ë°ì´í„° ì „ì†¡ ê°ì§€\n3. **Terraform ëª¨ë“ˆí™”** â€“ VPC ëª¨ë“ˆì— ì—”ë“œí¬ì¸íŠ¸ë¥¼ ê¸°ë³¸ í¬í•¨ì‹œì¼œ ëˆ„ë½ ë°©ì§€\n\n---\n\n## ì°¸ê³  ìë£Œ\n\n- [ì›ë³¸ ê¸°ì‚¬: $100k AWS ë¼ìš°íŒ… í•¨ì • (euno.news)](https://euno.news/posts/ko/the-100k-aws-routing-trap-s3-nat-gateways-and-how-307ce6)\n- [AWS VPC ì—”ë“œí¬ì¸íŠ¸ ê³µì‹ ë¬¸ì„œ](https://docs.aws.amazon.com/vpc/latest/privatelink/vpc-endpoints-s3.html)\n- [Terraform aws_vpc_endpoint ë¦¬ì†ŒìŠ¤](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/vpc_endpoint)\n\n---\n\n*ì´ ë¬¸ì„œëŠ” Issue #212ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.*\n",
  "lastModified": "2026-02-22T10:56:57+09:00",
  "author": "JHL",
  "status": "published",
  "isDraft": false,
  "isInvalid": false,
  "tags": [
    "AWS",
    "NAT Gateway",
    "S3",
    "Terraform",
    "ë¹„ìš© ìµœì í™”",
    "VPC"
  ],
  "order": 2,
  "history": [
    {
      "sha": "eb34079",
      "message": "ğŸŒ³ Wiki Tree Maintenance: ì „ì²´ 38ê°œì˜ ë¬¸ì„œê°€ 10ê°œì˜ ì¹´í…Œê³ ë¦¬(backend, bun, cloud, docker, frontend, ai, kubernetes, labels, projects, reports)ë¡œ ë¶„ë¥˜ë©ë‹ˆë‹¤. ì¤‘ë³µÂ·ë¶ˆí•„ìš”í•œ ì¹´í…Œê³ ë¦¬ì™€ ì‚­ì œëœ ë¬¸ì„œê°€ ì¡´ì¬í•´ êµ¬ì¡°ê°€ ë¹„íš¨ìœ¨ì ì´ë©°, íŒŒì¼ëª…Â·ê²½ë¡œ ì •ê·œí™”ê°€ í•„ìš”í•©ë‹ˆë‹¤.",
      "author": "GitHub Action",
      "authorEmail": "action@github.com",
      "date": "2026-02-22T02:01:15Z",
      "isAutoCommit": true,
      "additions": 0,
      "deletions": 0
    },
    {
      "sha": "77a095c",
      "message": "ğŸ”— êµì°¨ ì°¸ì¡° ì—…ë°ì´íŠ¸: 25ê°œ ë¬¸ì„œ",
      "author": "GitHub Action",
      "authorEmail": "action@github.com",
      "date": "2026-02-22T02:01:14Z",
      "isAutoCommit": true,
      "additions": 0,
      "deletions": 0
    },
    {
      "sha": "43539ff",
      "message": "Merge branch 'main' of github.com:jhl-labs/sepilot-wiki",
      "author": "JHL",
      "authorEmail": "bkperio@gmail.com",
      "date": "2026-02-22T10:59:01+09:00",
      "isAutoCommit": true,
      "additions": 0,
      "deletions": 0
    },
    {
      "sha": "e5a3aaa",
      "message": "docs: Issue #206,#208,#209,#210,#211,#212,#213,#214,#215 ì¼ê´„ ì²˜ë¦¬",
      "author": "JHL",
      "authorEmail": "bkperio@gmail.com",
      "date": "2026-02-22T10:56:57+09:00",
      "isAutoCommit": false,
      "additions": 0,
      "deletions": 0
    }
  ]
}