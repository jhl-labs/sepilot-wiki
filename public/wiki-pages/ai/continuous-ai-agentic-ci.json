{
  "title": "연속 AI 에이전트 CI 구축 가이드",
  "slug": "ai/continuous-ai-agentic-ci",
  "content": "\n# 연속 AI 에이전트 CI 구축 가이드\n\n이 문서는 CI 파이프라인에 **AI 코드 리뷰 에이전트**를 직접 구현하고, GitHub Actions 를 통해 자동화하는 방법을 단계별로 안내합니다. 아래 섹션에서는 에이전트 설계, CI 통합 단계, 예제 워크플로우 및 베스트 프랙티스를 다룹니다.\n\n---\n\n## 1. AI 코드 리뷰 에이전트 설계\n\n### 1.1 문제점 정의\n- **수동 PR 리뷰**는 리뷰어가 피곤할 때 놓치는 부분이 많고, 동일한 코멘트가 반복됩니다.\n- **빠른 PR**도 컨텍스트 재구축에 45분 정도 소요될 수 있습니다.\n\n### 1.2 AI‑powered 솔루션\nAI 모델을 이용해 모든 Pull Request 를 **구조화된 코드 리뷰**(정확성, 보안, 성능, 테스트) 로 자동 생성합니다. 모델은 OpenAI, Anthropic, OpenRouter, 혹은 로컬 Ollama 인스턴스를 자유롭게 선택할 수 있습니다.\n\n### 1.3 핵심 요소 – 리뷰 루브릭\n리뷰 루브릭(프롬프트/워크플로)은 모델 자체보다 중요한 역할을 합니다. 루브릭은 다음을 강제합니다:\n- **고위험 이슈**와 **사소한 지적** 구분\n- **구체적인 수정 방안** 및 **테스트 제안** 요구\n- \"내가 살펴본 내용\"과 \"확신이 없는 부분\" 명시\n\n### 1.4 모델 선택 전략\n\n프로젝트 특성에 따라 적합한 모델을 선택합니다:\n\n| 모델 옵션 | 장점 | 적합한 상황 |\n|-----------|------|-------------|\n| **OpenAI (GPT-4o 등)** | 높은 정확도, 풍부한 컨텍스트 이해 | 핵심 프로젝트, 보안 민감 코드 |\n| **Anthropic (Claude)** | 긴 컨텍스트 윈도우, 안전한 출력 | 대규모 diff 리뷰 |\n| **OpenRouter** | 다양한 모델 라우팅, 비용 최적화 | 모델별 비교 및 A/B 테스트 |\n| **Ollama (로컬)** | 비용 무료, 데이터 외부 전송 없음 | 프라이버시 민감 프로젝트 |\n\n---\n\n## 2. CI 파이프라인 통합 단계\n\n### 2.1 왜 CI 기반 리뷰인가?\n- **가격 구조**: 채팅 구독은 인터랙티브 사용에 적합하지만, CI 리뷰는 PR 발생 시에만 실행되어 비용 효율적입니다.\n- **사용량 기반 API**: 작은 PR에는 저비용 모델, 대규모 리팩터링에는 고성능 모델을 라우팅할 수 있습니다.\n- **로컬 모델**: Ollama 등 로컬 모델을 사용하면 비용이 거의 제로에 가깝습니다.\n\n### 2.2 DIY 파이프라인 제어 항목\n- 모델 선택 (OpenAI, Anthropic 등)\n- 최대 토큰 수\n- 실행 시점 (PR opened, synchronize, reopened 등)\n- \"검토할 가치가 있는\" 기준 정의\n\n### 2.3 리뷰 카테고리 구조화\n\n효과적인 AI 코드 리뷰를 위해 다음과 같이 카테고리를 구조화합니다:\n\n```text\n시스템 프롬프트 구조:\n├── 역할 정의 (시니어 리뷰어)\n├── 리뷰 카테고리 (정확성, 보안, 성능, 테스트)\n├── 출력 형식 (Markdown 구조)\n├── 확신도 표시 규칙 (높음/중간/낮음)\n├── \"검토한 내용\" vs \"확신하지 못하는 부분\" 구분\n└── 구체적 수정 코드 제안 요구\n```\n\n---\n\n## 3. 예제 워크플로우와 베스트 프랙티스\n\n### 3.1 GitHub Action 정의 (도구 기반)\n`.github/workflows/ai-code-review.yml` 파일을 생성합니다:\n\n```yaml\nname: AI Code Review\non:\n  pull_request:\n    types: [opened, synchronize, reopened]\njobs:\n  review:\n    runs-on: ubuntu-latest\n    permissions:\n      contents: read\n      pull-requests: write\n    steps:\n      - uses: actions/checkout@v4\n        with:\n          fetch-depth: 0\n      - name: Install Jazz (AI 리뷰 도구)\n        run: npm install -g jazz-ai\n      - name: Run code review workflow\n        run: jazz --output raw workflow run code-review --auto-approve\n        env:\n          OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}\n      - name: Generate review markdown\n        run: jazz --output raw workflow run code-review --auto-approve > review.md\n        env:\n          OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}\n      - name: Comment on PR\n        run: gh pr comment \"$PR_NUMBER\" --body-file review.md\n        env:\n          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n          PR_NUMBER: ${{ github.event.pull_request.number }}\n```\n\n> **참고** `--output raw` 옵션은 CI 환경에서 출력 캡처와 리다이렉션을 쉽게 해줍니다. `--auto-approve` 로 완전 자동화를 구현합니다. 권한은 최소화되었습니다.\n\n### 3.2 GitHub Action 정의 (API 직접 호출)\n\n도구 없이 API를 직접 호출하는 방식도 가능합니다. 별도의 구독료 없이 사용량 기반으로 비용을 관리할 수 있습니다:\n\n```yaml\nname: AI Code Review (API Direct)\non:\n  pull_request:\n    types: [opened, synchronize]\npermissions:\n  contents: read\n  pull-requests: write\njobs:\n  ai-review:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n        with:\n          fetch-depth: 0\n      - name: Get PR Diff\n        id: diff\n        run: |\n          DIFF=$(git diff origin/${{ github.base_ref }}...HEAD | head -c 10000)\n          echo \"diff<<EOF\" >> $GITHUB_OUTPUT\n          echo \"$DIFF\" >> $GITHUB_OUTPUT\n          echo \"EOF\" >> $GITHUB_OUTPUT\n      - name: AI Review\n        id: review\n        env:\n          OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}\n          DIFF: ${{ steps.diff.outputs.diff }}\n        run: |\n          REVIEW=$(curl -s https://api.openai.com/v1/chat/completions \\\n            -H \"Authorization: Bearer $OPENAI_API_KEY\" \\\n            -H \"Content-Type: application/json\" \\\n            -d '{\n              \"model\": \"gpt-4o\",\n              \"temperature\": 0.2,\n              \"max_tokens\": 2000,\n              \"messages\": [\n                {\n                  \"role\": \"system\",\n                  \"content\": \"코드 리뷰어로서 구조화된 리뷰를 작성하세요:\\n1. High-risk issues (보안, 정확성)\\n2. 개선 제안 (성능, 가독성)\\n3. 테스트 제안\\n각 항목에 확신도(높음/중간/낮음)를 표시하세요.\"\n                },\n                {\n                  \"role\": \"user\",\n                  \"content\": \"다음 diff를 리뷰해주세요:\\n'\"$DIFF\"'\"\n                }\n              ]\n            }' | jq -r '.choices[0].message.content')\n          echo \"review<<EOF\" >> $GITHUB_OUTPUT\n          echo \"$REVIEW\" >> $GITHUB_OUTPUT\n          echo \"EOF\" >> $GITHUB_OUTPUT\n      - name: Post Review Comment\n        uses: actions/github-script@v7\n        with:\n          script: |\n            await github.rest.issues.createComment({\n              owner: context.repo.owner,\n              repo: context.repo.repo,\n              issue_number: context.issue.number,\n              body: `## AI 코드 리뷰\\n\\n${{ steps.review.outputs.review }}\\n\\n---\\n*이 리뷰는 AI에 의해 자동 생성되었습니다. 참고용으로만 활용하세요.*`\n            });\n```\n\n### 3.3 리뷰 루브릭 (프롬프트) 정의\n`workflows/code-review/WORKFLOW.md` 파일을 생성하고 아래와 같이 정의합니다:\n\n```markdown\n---\nname: code-review\ndescription: Review PR diff and produce a structured report\nautoApprove: read-only\n---\nReview the current PR diff.\nOutput GitHub‑flavored Markdown with:\n1. **Summary** (2–4 bullets)\n2. **High‑risk issues** (correctness + security)\n3. **Performance / complexity concerns**\n4. **API / UX footguns**\n5. **Test gaps + concrete test suggestions**\n6. **Nitpicks** (style/readability)\n\n**Rules**\n- Be specific: reference files/functions.\n- Prefer minimal diffs / smallest safe fix.\n- If you're unsure, say so and propose how to verify.\n- No generic advice (\"add tests\") — propose exact test cases.\n- Rank issues (High/Medium/Low).\n- List files reviewed, assumptions, and what was not checked.\n```\n\n### 3.4 베스트 프랙티스 체크리스트\n\n| 항목 | 권고사항 |\n|------|----------|\n| **읽기 전용 모드** | `autoApprove` 를 `read-only` 로 유지해 에이전트가 저장소를 수정하지 못하도록 합니다 |\n| **이슈 순위 매기기** | 모든 이슈에 **High/Medium/Low** 라벨을 부여해 중요도를 명확히 합니다 |\n| **오탐 예산** | 잡음이 많으면 무시되므로, 평가 기준을 조정해 오탐을 최소화합니다 |\n| **모델 라우팅** | 작은 PR에는 저비용 모델, 대규모 리팩터링에는 고성능 모델 사용 |\n| **투명성** | 에이전트가 검토한 파일 목록, 가정, 검토하지 않은 항목을 명시하도록 요구합니다 |\n| **diff 크기 제한** | 토큰 한도 초과 방지를 위해 파일별로 분할하거나, 변경이 큰 파일은 요약만 전달 |\n| **비용 모니터링** | PR당 API 호출 비용을 추적하고, 월별 예산 알림을 설정 |\n| **리뷰 품질 피드백** | 리뷰 코멘트에 대한 반응을 수집하여 프롬프트를 지속적으로 개선 |\n| **점진적 도입** | 특정 디렉토리나 파일 패턴부터 시작하여, 팀의 신뢰도에 따라 범위를 확장 |\n\n### 3.5 실제 사례\nJazz 저장소는 자체 코드 리뷰와 릴리즈 노트에 **Jazz** 를 사용합니다. 워크플로 파일은 다음에서 확인할 수 있습니다: https://github.com/lvndry/jazz/tree/main/.github\n\n---\n\n## 4. 마무리\n위 가이드를 따라 CI 파이프라인에 AI 코드 리뷰 에이전트를 구현하면, **자동화된 고품질 리뷰**를 제공하면서 리뷰 비용을 크게 절감할 수 있습니다. 자체 파이프라인을 구축하면 모델 선택, 실행 시점, 비용 구조를 완전히 제어할 수 있다는 것이 가장 큰 장점입니다. 질문이나 개선 사항이 있으면 언제든 이슈를 열어 주세요.\n\n### 참고 자료\n- [CI에서 나만의 AI 코드 리뷰 에이전트 만들기 (euno.news)](https://euno.news/posts/ko/build-your-own-ai-code-review-agent-in-ci-738404)\n- [Jazz AI - GitHub](https://github.com/lvndry/jazz)\n- [GitHub Actions 공식 문서](https://docs.github.com/en/actions)\n",
  "lastModified": "2026-02-22T01:49:17Z",
  "author": "GitHub Action",
  "status": "published",
  "isDraft": false,
  "isInvalid": false,
  "tags": [
    "AI",
    "CI",
    "코드 리뷰",
    "에이전트"
  ],
  "order": 6,
  "history": [
    {
      "sha": "efb9e63",
      "message": "docs: Issue #199 - 문서 발행",
      "author": "GitHub Action",
      "authorEmail": "action@github.com",
      "date": "2026-02-22T01:49:17Z",
      "additions": 0,
      "deletions": 0
    }
  ]
}